#!/bin/bash

# (C) Copyright 2012-2013 Altair Engineering, Inc.  All rights reserved.
# This code is provided "as is" without any warranty, express or implied, or
# indemnification of any kind.  All other terms and conditions are as
# specified in the Altair PBS EULA.

# Assumption:
# This wrapper script assumes
#  1) PBS Server/Scheduler is running on the CMU Management Node.
#  2) Script is executed on the CMU Management Node.

# Purpose:
# Show the CMU Administrator the active jobs on the cluster
# otherwise, say there is no jobs in the system

# Source in PBS specific environment variables from pbs.conf
if [ -f /etc/pbs.conf ]; then
    . /etc/pbs.conf
else
    echo "Unable to find /etc/pbs.conf"
    exit 1
fi

qstat_out=`${PBS_EXEC}/bin/qstat`
if [ -z "$qstat_out" ]; then
    echo "No jobs in queue(s)"
else
    qstat -an1
fi
